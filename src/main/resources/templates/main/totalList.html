<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>전체 내역</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/totalList.css}" />
    <!-- jQuery 추가 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.3/font/bootstrap-icons.min.css">
    <!-- totalList.js 추가 -->
    <script src="/js/totalList.js" type="text/javascript"></script>
    <script>
        let page = 0;
        const size = 10; // 한 번에 로드할 데이터 수

        // 페이지가 로드되면 처음으로 데이터를 불러옵니다.
        $(document).ready(function() {
            const startDate = $('#start-date').val();
            const endDate = $('#end-date').val();
            loadTransactions(startDate, endDate);
        });

        function searchTransactions() {
            page = 0;
            $('#transaction-body').empty();
            const startDate = $('#start-date').val();
            const endDate = $('#end-date').val();
            loadTransactions(startDate, endDate);
        }

        // function loadTransactions() {
        //     $.ajax({
        //         url: `/api/transactions?page=${page}&size=${size}`,
        //         method: 'GET',
        //         success: function(data) {
        //             const tbody = $('#transaction-body');
        //             data.forEach(transaction => {
        //                 const row = `<tr>
        //                 <td>${transaction.date}</td>
        //                 <td>${transaction.description}</td>
        //                 <td>${transaction.category}</td>
        //                 <td>${transaction.amount}</td>
        //             </tr>`;
        //                 tbody.append(row);
        //             });
        //             page++;
        //         },
        //         error: function(error) {
        //             console.error('Error loading transactions', error);
        //         }
        //     });
        // }
        //
        // $(window).on('scroll', function() {
        //     if ($(window).scrollTop() + $(window).height() >= $(document).height() - 100) {
        //         loadTransactions();
        //     }
        // });
        //
        // // 페이지가 로드되면 처음으로 데이터를 불러옵니다.
        // $(document).ready(function() {
        //     loadTransactions();
        // });
    </script>
</head>
<body>
<header>
    <h1>가계부</h1>
    <nav>
        <ul>
            <li><a href="main.do">홈</a></li>
            <li><a href="transaction.do">거래 추가</a></li>
            <li><a href="report.do">보고서</a></li>
            <li><a href="totalList.do">전체내역</a></li>
            <li><a href="setting.do">설정</a></li>
        </ul>
    </nav>
    <div id="user-info">
        <span id="username">사용자이름</span>님
        <button id="modify-button" onclick="location.href='modify.do';">정보 수정</button>
        <button id="logout-button">로그아웃</button>
    </div>
</header>
<main>
    <section class="recent-transactions">
        <h2>최신 거래 내역</h2>
        <div class="date-search">
            <label for="start-date">시작 날짜:</label>
            <input type="date" id="start-date" name="start-date">
            <label for="end-date">종료 날짜:</label>
            <input type="date" id="end-date" name="end-date">
            <button onclick="searchTransactions()">검색</button>
        </div>
        <table>
            <thead>
            <tr>
                <th>날짜</th>
                <th>설명</th>
                <th>카테고리</th>
                <th>금액</th>
                <th>거래 구분</th>
                <th>삭제</th> <!-- 삭제 컬럼 추가 -->
            </tr>
            </thead>
            <tbody id="transaction-body">
            <!-- 초기 데이터 -->
            <tr>
                <td>2024-05-19</td>
                <td>지하철 요금</td>
                <td>교통비</td>
                <td>₩2,500</td> <!-- 거래 구분 데이터 추가 -->
                <td>지출</td>
                <td><button class="delete-btn" data-id="1"><i class="bi bi-trash"></i></button></td> <!-- 삭제 버튼 추가 -->
            </tr>
            </tbody>
        </table>
    </section>
</main>
</body>
</html>